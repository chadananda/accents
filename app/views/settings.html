<script>
	$("#main-container").loader('show','<img src="images/loading-x.gif">');
</script>
<div class="addtext row" ng-controller="getdataCtrl" ng-init="settingsInit()">
	<h2 class="pl15 pr15" style="font-weight:bold;">Utilities</h2>
	<div class="panel-box">
		<div class="row mb10">
			<div class="col-sm-8 col-xs-8">
				<input name="remoteDbUrl" id="remoteDbUrl" ng-model="remoteDbUrl" class="form-control" placeholder="Enter the Remote Db Url" ng-change="changeDb()" />
			</div>
			<div class="col-sm-4 col-xs-4" >
				<button type="button" class="btn btn-primary" ng-click="replicateToRemote();" >Replicate</button>
			</div>
		</div>
		<div class="row mb10">
			<div class="col-sm-10 col-xs-10">
				<button class="btn btn-primary btn-block" ng-click="cleanupAndCompress()">
					<span class="glyphicon glyphicon-trash" style="float: left !important;margin-left: 2% !important;"></span>
					Cleanup & Compress Database
				</button>
			</div>
			<div class="col-sm-2 col-xs-2" >
				<button type="button" class="btn btn-primary btn-circle" id="firstClick" ng-click="slideShow('firstBox');">
				<span class="glyphicon glyphicon-question-sign" style="color:white;"></span>
				</button>
			</div>
		</div>
		<div class="row" id="firstBox" style="display:none;">
			<div class="col-sm-10 col-xs-10">
				<div class="well first-well">
					<h4>Cleanup Database</h4>
					<p>
						<ul>
							<li>
								Remove records which exactly match another record -- 
								comparing the four primary content fields which are:   
								<b>term, source, original </b>and<b> definition</b>
							</li>
							<li>
								Add a <b>word-family</b> field to all records missing this field
							</li>
							<li>
								Remove all but the following fields:
								<ul>
									<li><b>term, source, original, definition, type, user, word-family, verified, ambiguous, audio, _id</b> and <b> _rev</b></li>
								</ul>
							</li>
						</ul>
					</p>
					<h4>Compress Records</h4>
					<p>
						<ul>
							<li>Set all fields with an <b>original</b> entry to <b>verified</b>.</li>
							<li>
								If a word-family group contains more than one verified record, set each to <b>ambiguous</b>
								<ul>
								<li>For all word families with at least one ambiguous record, mark all other records in that word family as ambiguous</li>
								</ul>
							</li>
							<li>For each word family containing just one verified record, delete non-verified records -- appending their <b>reference</b> values to the <b>reference</b> field of the one remaining verified record. (Comma + space delimited)</li>										
						</ul>
					</p>
				</div>
			</div>
		</div>
		<h5 class="blankalert"> {{message}}</h5>
	</div>
</div>


